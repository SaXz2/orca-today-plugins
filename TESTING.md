# Today插件测试指南

## 测试步骤

### 1. 部署插件
1. 将 `dist/index.js` 文件复制到 Orca Note 的插件目录
2. 重启 Orca Note
3. 在设置中启用 "orca-plugin-today" 插件

### 2. 创建测试标签
在任意块中添加 `#Today` 标签：

```
# 测试Today标签
- [ ] 任务1 #Today
- [ ] 任务2 #Today
- [ ] 任务3 #Today
```

### 3. 查看控制台日志
1. 打开开发者工具（F12）
2. 查看控制台输出
3. 应该看到类似这样的日志：

```
找到 3 个带有Today标签的块
处理块 xxx: {块数据}
块 xxx 没有Today属性引用，尝试使用insertTag创建...
成功为Today标签创建测试属性"1": 块 xxx
Today标签日期更新完成，更新了 3 个标签
```

### 4. 验证测试属性"1"
插件现在会为Today标签创建一个名为"1"的测试属性：
- 属性名：`1`
- 属性值：当前日期
- 用途：验证API调用是否成功

### 5. 验证功能
插件应该自动：
- 检测到带有 `#Today` 标签的块
- 为这些块创建Today属性引用
- 添加测试属性"1"（值为当前日期）
- 每30秒检查新添加的Today标签
- 每小时自动更新测试属性"1"

### 6. 手动触发更新
如果需要立即测试：
1. 打开命令面板（Ctrl+Shift+P 或 Cmd+Shift+P）
2. 搜索 "更新Today标签的日期属性"
3. 执行命令
4. 查看控制台输出

## 预期结果

### 成功情况
- 控制台显示成功创建Today标签和date属性
- 块应该有Today属性引用
- date属性应该包含当前日期

### 失败情况
如果看到错误信息，可能的原因：
1. **API权限问题**：检查插件是否有足够权限
2. **API调用错误**：检查控制台错误信息
3. **数据结构问题**：检查块的数据结构

## 调试信息

### 正常日志
```
找到 X 个带有Today标签的块
处理块 xxx: {块数据}
块 xxx 没有Today属性引用，尝试使用insertTag创建...
成功为块 xxx 创建Today标签和date属性
Today标签日期更新完成，更新了 X 个标签
```

### 错误日志
```
为块 xxx 创建Today标签失败: [错误信息]
为块 xxx 强制创建date属性失败: [错误信息]
更新块 xxx 时出错: [错误信息]
```

## 故障排除

### 问题1：插件没有自动运行
- 检查插件是否已启用
- 查看控制台是否有错误信息
- 尝试手动触发更新命令

### 问题2：创建Today标签失败
- 检查API权限
- 查看具体错误信息
- 尝试重新启动Orca Note

### 问题3：date属性没有创建
- 检查Today属性引用是否正确创建
- 查看setRefData调用是否成功
- 检查日期值是否正确

## 联系支持

如果问题仍然存在，请提供：
1. 控制台的完整错误日志
2. 测试块的数据结构
3. Orca Note的版本信息
4. 插件的版本信息
